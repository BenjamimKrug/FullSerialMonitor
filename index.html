<html>

<head>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="header" style="width:80%">
        <input type="text" id="send_input" style="width:70%" disabled>
        <button id="send_button" onclick="sendData()" disabled>Send</button>
        <select id="line_ending" style="width:120px" onchange="updatePreferences()" disabled>
            <option value="">No line ending</option>
            <option value='\n'>LF(New line)</option>
            <option value='\r'>CR(Carriage return)</option>
            <option value="\r\n">CR+LF(Carriage return + New line)</option>
        </select>
    </div>
    <div class="box terminal" id="terminal">
    </div>
    OUTPUT
    <br>
    <div class="box output" id="output">
    </div>

    <div id="config_menu" class="config_menu" style="display:none">
        Log file
        <br>
        <select id="log_type">
            <option value="none">None</option>
            <option value="w">Overwrite</option>
            <option value="a">Append</option>
        </select>
        <input type="checkbox" id="log_add_timestamp" />
        <label for="log_add_timestamp">Add Timestamp</label>
        <br>
        <input type="text" id="log_folder_input" class="file_path" />
        <input type="file" id="log_folder" style="display:none" onchange="readDirPaths(true, false)" webkitdirectory />
        <input type="button" value="Browse..." class="general_btn" style="right: 5px;" onclick="log_folder.click();" />
        <br><br>

        Exception decoder
        <br>
        <label>
            Arduino packages folder<br>
            <input type="text" id="decoder_folder_input" class="file_path" />
            <input type="file" id="decoder_folder" style="display:none" onchange="readDirPaths(false,true)"
                webkitdirectory />
            <input type="button" value="Browse..." class="general_btn" style="right: 5px;"
                onclick="decoder_folder.click();" />
            <br>
            <input type="color" id="decoder_color" />
        </label>
        <br><br>

        Miscellaneous
        <br>
        <input type="checkbox" id="ctrl_enter" />
        <label for="ctrl_enter">Use Ctrl key to send</label>
        <br><br>
        JSON parser color&nbsp&nbsp
        <input type="color" id="json_color" />
        <br><br>
        Custom parsers
        <button id="add_custom_parser" onclick="createCustomParserField()">+</button>
        <br>
        <div id="custom_parsers_div" class="box customParsersDiv">
        </div>
        <button onclick="backupPreferences();config_menu.style.display = 'none'" class="general_btn close_btn"
            style="right: 150px;position: fixed;">
            Cancel
        </button>
        <button onclick="updatePreferences();config_menu.style.display = 'none'" class="general_btn close_btn"
            style="right: 10px;position: fixed;">
            Save and Close
        </button>
    </div>

    <div id="options_menu" class="options_menu">
        <button id="open_config_menu" class="general_btn" style="right:5px">
            <img src="./images/settings gear.png" width="12" height="12">
            Config
        </button>
        <br><br>
        <label for="auto_scroll" class="label_left">autoScroll</label>
        <input type="checkbox" id="auto_scroll" onchange="updatePreferences()" class="checkbox_options">
        <br>

        <label for="add_timestamp" class="label_left">Add Timestamp</label>
        <input type="checkbox" id="add_timestamp" class="checkbox_options"
            onchange="updatePreferences();changeTimestamp()">
        <br>

        <select id="com_ports" class="select_input">
        </select>
        <button id="list_ports" class="general_btn" style="right: 5px;" onclick="getPorts()">LIST</button>
        <br>

        <select id="baudrate_input" class="select_input">
            <option>4800</option>
            <option>9600</option>
            <option>19200</option>
            <option>38400</option>
            <option>57600</option>
            <option>115200</option>
            <option>230400</option>
            <option>460800</option>
            <option>500000</option>
            <option>921600</option>
            <option>1000000</option>
        </select>
        <label for="baudrate" style="position:absolute;right:25px;transform: translate(0, 10%);">bps</label>
        <br><br>
        <button id="connect_serial" class="options_button" onclick="connect()">
            <img src="./images/usb-connected-16.png" width="16" height="16">
            CONNECT
        </button>
        <br><br>
        <button id="disconnect_serial" class="options_button" onclick="disconnect()">
            <img src="./images/usb-disconnected-16.png" width="16" height="16">
            DISCONNECT
        </button><br><br>
        <button id="clean_terminal" class="options_button" onclick="cleanTerminal()">
            <img src="./images/trash-2-16.png" width="16" height="16">
            CLEAN
        </button><br><br>

        ESP EXCEPTION DECODER
        <label for="decoder_arch" style="position:relative;left:5%">Arch</label>
        <select id="decoder_arch" class="select_input" style="right:5%">
            <option value="esp32">ESP32</option>
            <option value="esp8266">ESP8266</option>
        </select>
        <br>
        ELF File<br>
        <input type="text" id="elf_path_input" class="file_path" style="width:60%" />
        <input type="file" id="elf_path" style="display:none" onchange="getELF();" />
        <input type="button" value="Browse..." class="general_btn" onclick="elf_path.click();" />

        OUTPUT HISTORY
        <div class="dropdown">
            <button class="dropbtn">Dropdown</button>
            <div class="dropdown-content">
                <label for="json_filter">JSON parser</label>
                <input type="checkbox" id="json_filter" onchange="updateParserHistory(this)" data-parser="json" class="checkbox_options">
                <br>
                <label for="decoder_filter">Exception decoder</label>
                <input type="checkbox" id="decoder_filter" onchange="updateParserHistory(this)" data-parser="expDecoder" class="checkbox_options">
            </div>
        </div>
        <br>
        <div class="box output_history" id="output_history" style="width:90%">
        </div>
    </div>
    <script src="./renderer.js"></script>
    <script src="./preferences_handle.js"></script>
    <script src="./parsers.js"></script>
    <script src="./decoder.js"></script>
</body>

</html>